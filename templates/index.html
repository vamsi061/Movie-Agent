
        // Gofile Priority Enhancement for SkySetX
        function checkGofilePriorityAndEnhance(originalIndex, unlockedLinks, originalLinkDiv) {
            // Check for Gofile prioritization and health
            fetch("/check_links_health", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ links: unlockedLinks })
            })
            .then(response => response.json())
            .then(data => {
                if (data.status === "success") {
                    displayPriorityEnhancedLinks(originalIndex, data, originalLinkDiv);
                }
            })
            .catch(error => {
                console.error("Priority check error:", error);
            });
        }

        function displayPriorityEnhancedLinks(originalIndex, data, originalLinkDiv) {
            const enhancedLinks = data.enhanced_links;
            const hasGofilePriority = data.has_gofile_priority;
            const hiddenCount = data.hidden_links_count;
            const workingCount = data.working_count;

            // Update download button
            const downloadBtn = originalLinkDiv.querySelector(".download-btn");
            if (downloadBtn) {
                if (hasGofilePriority) {
                    downloadBtn.textContent = "GOFILE PRIORITY (" + workingCount + "/" + enhancedLinks.length + " Working)";
                    downloadBtn.style.background = "linear-gradient(45deg, #FFD700, #FFA500)";
                    downloadBtn.style.color = "black";
                    downloadBtn.style.fontWeight = "bold";
                } else {
                    downloadBtn.textContent = "Health Checked (" + workingCount + "/" + enhancedLinks.length + " Working)";
                    downloadBtn.style.background = "linear-gradient(45deg, #4CAF50, #45a049)";
                }
            }

            // Update dropdown button
            const dropdownBtn = originalLinkDiv.querySelector(".dropdown-arrow");
            if (dropdownBtn) {
                if (hasGofilePriority) {
                    dropdownBtn.innerHTML = "v Priority Links (" + enhancedLinks.length + ")" + (hiddenCount > 0 ? " - " + hiddenCount + " Others Hidden" : "");
                    dropdownBtn.style.background = "linear-gradient(45deg, #FFD700, #FFA500)";
                    dropdownBtn.style.color = "black";
                    dropdownBtn.style.fontWeight = "bold";
                } else {
                    dropdownBtn.innerHTML = "v Show Links (" + enhancedLinks.length + ") - " + workingCount + " Working";
                }
            }

            // Update the unlocked links container
            const unlockedContainer = originalLinkDiv.querySelector("#unlocked-container-" + originalIndex);
            if (unlockedContainer) {
                unlockedContainer.innerHTML = ""; // Clear existing content

                // Add each enhanced link with priority styling
                enhancedLinks.forEach((link, subIndex) => {
                    const linkItem = document.createElement("div");
                    linkItem.className = "unlocked-link-item";
                    
                    const isPriority = link.is_priority || false;
                    const isWorking = link.is_working || false;
                    const healthStatus = link.health_status || "unknown";
                    
                    let statusIcon = "";
                    let statusColor = "";
                    let borderColor = "";
                    let buttonStyle = "";
                    
                    if (isPriority && isWorking) {
                        statusIcon = "[GOFILE PRIORITY]";
                        statusColor = "#FFD700";
                        borderColor = "#FFD700";
                        buttonStyle = "background: linear-gradient(45deg, #FFD700, #FFA500); color: black; font-weight: bold; box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);";
                    } else if (isPriority && !isWorking) {
                        statusIcon = "[GOFILE BROKEN]";
                        statusColor = "#FFA500";
                        borderColor = "#FFA500";
                        buttonStyle = "background: linear-gradient(45deg, #FFA500, #FF6347); color: white; font-weight: bold;";
                    } else if (!isPriority && isWorking) {
                        statusIcon = "[WORKING]";
                        statusColor = "#4CAF50";
                        borderColor = "#4CAF50";
                        buttonStyle = "background: linear-gradient(45deg, #4CAF50, #45a049); color: white;";
                    } else {
                        statusIcon = "[BROKEN]";
                        statusColor = "#F44336";
                        borderColor = "#F44336";
                        buttonStyle = "background: linear-gradient(45deg, #F44336, #D32F2F); color: white;";
                    }
                    
                    // Enhanced styling for priority links
                    let itemStyle = 
                        "border: 2px solid " + borderColor + "; " +
                        "border-radius: 8px; " +
                        "margin: 8px 0; " +
                        "padding: 12px; " +
                        "background: rgba(255,255,255,0.1); " +
                        "backdrop-filter: blur(5px);";
                    
                    if (isPriority) {
                        itemStyle += "box-shadow: 0 0 20px rgba(255, 215, 0, 0.3);";
                    }
                    
                    linkItem.style.cssText = itemStyle;
                    
                    linkItem.innerHTML = 
                        "<div class=\"unlocked-link-title\" style=\"color: " + statusColor + "; font-weight: bold; font-size: 1.1rem;\">" +
                            statusIcon + " " + (link.text || link.service_type + " Download") +
                        "</div>" +
                        "<div class=\"unlocked-link-meta\" style=\"margin: 8px 0; font-size: 0.9rem; line-height: 1.4;\">" +
                            "Host: <strong>" + (link.host || "Unknown") + "</strong> | " +
                            "Quality: <strong>" + (link.quality || "Unknown") + "</strong> | " +
                            "Size: <strong>" + (link.file_size || "Unknown") + "</strong><br>" +
                            "Status: <strong style=\"color: " + statusColor + "\">" + healthStatus.toUpperCase() + "</strong>" +
                            (link.status_code ? " (HTTP " + link.status_code + ")" : "") +
                        "</div>" +
                        "<a href=\"" + link.url + "\" class=\"unlocked-download-btn\" target=\"_blank\" " +
                            "style=\"" + buttonStyle + " padding: 12px 24px; border-radius: 8px; text-decoration: none; display: inline-block; margin-top: 8px; transition: all 0.3s ease;\" " +
                            "onmouseover=\"this.style.transform=\\"scale(1.05)\\"\" onmouseout=\"this.style.transform=\\"scale(1)\\"\">" +
                            (isWorking ? (isPriority ? "PRIORITY DOWNLOAD" : "Download") : "Try Anyway") +
                        "</a>";
                    
                    unlockedContainer.appendChild(linkItem);
                });
            }
        }

        // Override the original displayUnlockedLinks to add priority checking
        const originalDisplayUnlockedLinks = window.displayUnlockedLinks;
        window.displayUnlockedLinks = function(originalIndex, unlockedLinks, originalLinkDiv) {
            // Call the original function first
            if (originalDisplayUnlockedLinks) {
                originalDisplayUnlockedLinks(originalIndex, unlockedLinks, originalLinkDiv);
            }
            
            // Then enhance with Gofile priority checking
            setTimeout(() => {
                checkGofilePriorityAndEnhance(originalIndex, unlockedLinks, originalLinkDiv);
            }, 1000);
        };

